[Skip to content](https://github.com/SesameAILabs/csm#start-of-content)

You signed in with another tab or window. [Reload](https://github.com/SesameAILabs/csm) to refresh your session.You signed out in another tab or window. [Reload](https://github.com/SesameAILabs/csm) to refresh your session.You switched accounts on another tab or window. [Reload](https://github.com/SesameAILabs/csm) to refresh your session.Dismiss alert

[SesameAILabs](https://github.com/SesameAILabs)/ **[csm](https://github.com/SesameAILabs/csm)** Public

- [Notifications](https://github.com/login?return_to=%2FSesameAILabs%2Fcsm) You must be signed in to change notification settings
- [Fork\\
955](https://github.com/login?return_to=%2FSesameAILabs%2Fcsm)
- [Star\\
11.6k](https://github.com/login?return_to=%2FSesameAILabs%2Fcsm)


A Conversational Speech Generation Model


### License

[Apache-2.0 license](https://github.com/SesameAILabs/csm/blob/main/LICENSE)

[11.6k\\
stars](https://github.com/SesameAILabs/csm/stargazers) [955\\
forks](https://github.com/SesameAILabs/csm/forks) [Branches](https://github.com/SesameAILabs/csm/branches) [Tags](https://github.com/SesameAILabs/csm/tags) [Activity](https://github.com/SesameAILabs/csm/activity)

[Star](https://github.com/login?return_to=%2FSesameAILabs%2Fcsm)

[Notifications](https://github.com/login?return_to=%2FSesameAILabs%2Fcsm) You must be signed in to change notification settings

# SesameAILabs/csm

main

[**2** Branches](https://github.com/SesameAILabs/csm/branches) [**0** Tags](https://github.com/SesameAILabs/csm/tags)

[Go to Branches page](https://github.com/SesameAILabs/csm/branches)[Go to Tags page](https://github.com/SesameAILabs/csm/tags)

Go to file

Code

## Folders and files

| Name | Name | Last commit message | Last commit date |
| --- | --- | --- | --- |
| ## Latest commit<br>[![ZackHodari](https://avatars.githubusercontent.com/u/9717211?v=4&size=40)](https://github.com/ZackHodari)[ZackHodari](https://github.com/SesameAILabs/csm/commits?author=ZackHodari)<br>[Check audio is single channel (](https://github.com/SesameAILabs/csm/commit/ebab2a584c9454791f4a5548091d6182783a2915) [#117](https://github.com/SesameAILabs/csm/pull/117) [)](https://github.com/SesameAILabs/csm/commit/ebab2a584c9454791f4a5548091d6182783a2915)<br>Mar 23, 2025<br>[ebab2a5](https://github.com/SesameAILabs/csm/commit/ebab2a584c9454791f4a5548091d6182783a2915) · Mar 23, 2025<br>## History<br>[22 Commits](https://github.com/SesameAILabs/csm/commits/main/) |
| [.gitignore](https://github.com/SesameAILabs/csm/blob/main/.gitignore ".gitignore") | [.gitignore](https://github.com/SesameAILabs/csm/blob/main/.gitignore ".gitignore") | [Add example run script (](https://github.com/SesameAILabs/csm/commit/ed90181a15de0ed4a32a4f83363bfa2a54093c10 "Add example run script (#66)  * feat: Add Gradio web interface and improve setup  - Add run_csm_gradio.py for interactive web interface with features:   - Choose from predefined voice prompts   - Upload or record custom voice prompts   - Enter multi-turn conversations   - Generate and play audio directly in browser - Update requirements.txt with Gradio and CPU-only dependencies - Add .gitignore for Python, audio files, and model checkpoints - Update README with:   - Gradio interface instructions   - ffmpeg installation steps   - Prompt file download instructions   - Environment variable setup for Triton - Fix Triton import issues with CPU-only mode - Improve code organization and error handling  The web interface enables both quick testing with predefined voices and experimentation with custom voice inputs through recording or upload.  * Add CUDA support  * Delete run_csm_gradio.py  * Update Readme, requirements, and devices  * Review changes  * Update run_csm.py  Co-authored-by: ZackHodari <zackhodari@gmail.com>  * Review changes  * Fix Readme  * Review changes  * Removed extra code and modules  ---------  Co-authored-by: Akash Gupta <149550276+akash-gupta-parloa@users.noreply.github.com> Co-authored-by: ZackHodari <zackhodari@gmail.com>") [#66](https://github.com/SesameAILabs/csm/pull/66) [)](https://github.com/SesameAILabs/csm/commit/ed90181a15de0ed4a32a4f83363bfa2a54093c10 "Add example run script (#66)  * feat: Add Gradio web interface and improve setup  - Add run_csm_gradio.py for interactive web interface with features:   - Choose from predefined voice prompts   - Upload or record custom voice prompts   - Enter multi-turn conversations   - Generate and play audio directly in browser - Update requirements.txt with Gradio and CPU-only dependencies - Add .gitignore for Python, audio files, and model checkpoints - Update README with:   - Gradio interface instructions   - ffmpeg installation steps   - Prompt file download instructions   - Environment variable setup for Triton - Fix Triton import issues with CPU-only mode - Improve code organization and error handling  The web interface enables both quick testing with predefined voices and experimentation with custom voice inputs through recording or upload.  * Add CUDA support  * Delete run_csm_gradio.py  * Update Readme, requirements, and devices  * Review changes  * Update run_csm.py  Co-authored-by: ZackHodari <zackhodari@gmail.com>  * Review changes  * Fix Readme  * Review changes  * Removed extra code and modules  ---------  Co-authored-by: Akash Gupta <149550276+akash-gupta-parloa@users.noreply.github.com> Co-authored-by: ZackHodari <zackhodari@gmail.com>") | Mar 19, 2025 |
| [LICENSE](https://github.com/SesameAILabs/csm/blob/main/LICENSE "LICENSE") | [LICENSE](https://github.com/SesameAILabs/csm/blob/main/LICENSE "LICENSE") | [Initial commit](https://github.com/SesameAILabs/csm/commit/af78feb1fffb0cc0dd7109b6364d41457bbbdf5b "Initial commit") | Feb 26, 2025 |
| [README.md](https://github.com/SesameAILabs/csm/blob/main/README.md "README.md") | [README.md](https://github.com/SesameAILabs/csm/blob/main/README.md "README.md") | [Add example run script (](https://github.com/SesameAILabs/csm/commit/ed90181a15de0ed4a32a4f83363bfa2a54093c10 "Add example run script (#66)  * feat: Add Gradio web interface and improve setup  - Add run_csm_gradio.py for interactive web interface with features:   - Choose from predefined voice prompts   - Upload or record custom voice prompts   - Enter multi-turn conversations   - Generate and play audio directly in browser - Update requirements.txt with Gradio and CPU-only dependencies - Add .gitignore for Python, audio files, and model checkpoints - Update README with:   - Gradio interface instructions   - ffmpeg installation steps   - Prompt file download instructions   - Environment variable setup for Triton - Fix Triton import issues with CPU-only mode - Improve code organization and error handling  The web interface enables both quick testing with predefined voices and experimentation with custom voice inputs through recording or upload.  * Add CUDA support  * Delete run_csm_gradio.py  * Update Readme, requirements, and devices  * Review changes  * Update run_csm.py  Co-authored-by: ZackHodari <zackhodari@gmail.com>  * Review changes  * Fix Readme  * Review changes  * Removed extra code and modules  ---------  Co-authored-by: Akash Gupta <149550276+akash-gupta-parloa@users.noreply.github.com> Co-authored-by: ZackHodari <zackhodari@gmail.com>") [#66](https://github.com/SesameAILabs/csm/pull/66) [)](https://github.com/SesameAILabs/csm/commit/ed90181a15de0ed4a32a4f83363bfa2a54093c10 "Add example run script (#66)  * feat: Add Gradio web interface and improve setup  - Add run_csm_gradio.py for interactive web interface with features:   - Choose from predefined voice prompts   - Upload or record custom voice prompts   - Enter multi-turn conversations   - Generate and play audio directly in browser - Update requirements.txt with Gradio and CPU-only dependencies - Add .gitignore for Python, audio files, and model checkpoints - Update README with:   - Gradio interface instructions   - ffmpeg installation steps   - Prompt file download instructions   - Environment variable setup for Triton - Fix Triton import issues with CPU-only mode - Improve code organization and error handling  The web interface enables both quick testing with predefined voices and experimentation with custom voice inputs through recording or upload.  * Add CUDA support  * Delete run_csm_gradio.py  * Update Readme, requirements, and devices  * Review changes  * Update run_csm.py  Co-authored-by: ZackHodari <zackhodari@gmail.com>  * Review changes  * Fix Readme  * Review changes  * Removed extra code and modules  ---------  Co-authored-by: Akash Gupta <149550276+akash-gupta-parloa@users.noreply.github.com> Co-authored-by: ZackHodari <zackhodari@gmail.com>") | Mar 19, 2025 |
| [generator.py](https://github.com/SesameAILabs/csm/blob/main/generator.py "generator.py") | [generator.py](https://github.com/SesameAILabs/csm/blob/main/generator.py "generator.py") | [Check audio is single channel (](https://github.com/SesameAILabs/csm/commit/ebab2a584c9454791f4a5548091d6182783a2915 "Check audio is single channel (#117)") [#117](https://github.com/SesameAILabs/csm/pull/117) [)](https://github.com/SesameAILabs/csm/commit/ebab2a584c9454791f4a5548091d6182783a2915 "Check audio is single channel (#117)") | Mar 23, 2025 |
| [models.py](https://github.com/SesameAILabs/csm/blob/main/models.py "models.py") | [models.py](https://github.com/SesameAILabs/csm/blob/main/models.py "models.py") | [Improve HF integration (download stats + safetensors serialization) (](https://github.com/SesameAILabs/csm/commit/836f886515f0dec02c22ed2316cc78904bdc0f36 "Improve HF integration (download stats + safetensors serialization) (#59)  * Squash commits  * Update files  * Remove script  * Rename args to config  * Remove unused import") [#59](https://github.com/SesameAILabs/csm/pull/59) | Mar 16, 2025 |
| [requirements.txt](https://github.com/SesameAILabs/csm/blob/main/requirements.txt "requirements.txt") | [requirements.txt](https://github.com/SesameAILabs/csm/blob/main/requirements.txt "requirements.txt") | [release](https://github.com/SesameAILabs/csm/commit/8f6d947a26f6301deec9696f9bfb28e9e2e0d7d5 "release") | Mar 13, 2025 |
| [run\_csm.py](https://github.com/SesameAILabs/csm/blob/main/run_csm.py "run_csm.py") | [run\_csm.py](https://github.com/SesameAILabs/csm/blob/main/run_csm.py "run_csm.py") | [Add example run script (](https://github.com/SesameAILabs/csm/commit/ed90181a15de0ed4a32a4f83363bfa2a54093c10 "Add example run script (#66)  * feat: Add Gradio web interface and improve setup  - Add run_csm_gradio.py for interactive web interface with features:   - Choose from predefined voice prompts   - Upload or record custom voice prompts   - Enter multi-turn conversations   - Generate and play audio directly in browser - Update requirements.txt with Gradio and CPU-only dependencies - Add .gitignore for Python, audio files, and model checkpoints - Update README with:   - Gradio interface instructions   - ffmpeg installation steps   - Prompt file download instructions   - Environment variable setup for Triton - Fix Triton import issues with CPU-only mode - Improve code organization and error handling  The web interface enables both quick testing with predefined voices and experimentation with custom voice inputs through recording or upload.  * Add CUDA support  * Delete run_csm_gradio.py  * Update Readme, requirements, and devices  * Review changes  * Update run_csm.py  Co-authored-by: ZackHodari <zackhodari@gmail.com>  * Review changes  * Fix Readme  * Review changes  * Removed extra code and modules  ---------  Co-authored-by: Akash Gupta <149550276+akash-gupta-parloa@users.noreply.github.com> Co-authored-by: ZackHodari <zackhodari@gmail.com>") [#66](https://github.com/SesameAILabs/csm/pull/66) [)](https://github.com/SesameAILabs/csm/commit/ed90181a15de0ed4a32a4f83363bfa2a54093c10 "Add example run script (#66)  * feat: Add Gradio web interface and improve setup  - Add run_csm_gradio.py for interactive web interface with features:   - Choose from predefined voice prompts   - Upload or record custom voice prompts   - Enter multi-turn conversations   - Generate and play audio directly in browser - Update requirements.txt with Gradio and CPU-only dependencies - Add .gitignore for Python, audio files, and model checkpoints - Update README with:   - Gradio interface instructions   - ffmpeg installation steps   - Prompt file download instructions   - Environment variable setup for Triton - Fix Triton import issues with CPU-only mode - Improve code organization and error handling  The web interface enables both quick testing with predefined voices and experimentation with custom voice inputs through recording or upload.  * Add CUDA support  * Delete run_csm_gradio.py  * Update Readme, requirements, and devices  * Review changes  * Update run_csm.py  Co-authored-by: ZackHodari <zackhodari@gmail.com>  * Review changes  * Fix Readme  * Review changes  * Removed extra code and modules  ---------  Co-authored-by: Akash Gupta <149550276+akash-gupta-parloa@users.noreply.github.com> Co-authored-by: ZackHodari <zackhodari@gmail.com>") | Mar 19, 2025 |
| [setup.py](https://github.com/SesameAILabs/csm/blob/main/setup.py "setup.py") | [setup.py](https://github.com/SesameAILabs/csm/blob/main/setup.py "setup.py") | [Add setup.py](https://github.com/SesameAILabs/csm/commit/87efd30ac08e1b209f35455322e718f14195ea69 "Add setup.py") | Mar 21, 2025 |
| [watermarking.py](https://github.com/SesameAILabs/csm/blob/main/watermarking.py "watermarking.py") | [watermarking.py](https://github.com/SesameAILabs/csm/blob/main/watermarking.py "watermarking.py") | [release](https://github.com/SesameAILabs/csm/commit/8f6d947a26f6301deec9696f9bfb28e9e2e0d7d5 "release") | Mar 13, 2025 |
| View all files |

## Repository files navigation

# CSM

[Permalink: CSM](https://github.com/SesameAILabs/csm#csm)

**2025/03/13** \- We are releasing the 1B CSM variant. The checkpoint is [hosted on Hugging Face](https://huggingface.co/sesame/csm_1b).

* * *

CSM (Conversational Speech Model) is a speech generation model from [Sesame](https://www.sesame.com/) that generates RVQ audio codes from text and audio inputs. The model architecture employs a [Llama](https://www.llama.com/) backbone and a smaller audio decoder that produces [Mimi](https://huggingface.co/kyutai/mimi) audio codes.

A fine-tuned variant of CSM powers the [interactive voice demo](https://www.sesame.com/voicedemo) shown in our [blog post](https://www.sesame.com/research/crossing_the_uncanny_valley_of_voice).

A hosted [Hugging Face space](https://huggingface.co/spaces/sesame/csm-1b) is also available for testing audio generation.

## Requirements

[Permalink: Requirements](https://github.com/SesameAILabs/csm#requirements)

- A CUDA-compatible GPU
- The code has been tested on CUDA 12.4 and 12.6, but it may also work on other versions
- Similarly, Python 3.10 is recommended, but newer versions may be fine
- For some audio operations, `ffmpeg` may be required
- Access to the following Hugging Face models:
  - [Llama-3.2-1B](https://huggingface.co/meta-llama/Llama-3.2-1B)
  - [CSM-1B](https://huggingface.co/sesame/csm-1b)

### Setup

[Permalink: Setup](https://github.com/SesameAILabs/csm#setup)

```
git clone git@github.com:SesameAILabs/csm.git
cd csm
python3.10 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

# Disable lazy compilation in Mimi
export NO_TORCH_COMPILE=1

# You will need access to CSM-1B and Llama-3.2-1B
huggingface-cli login
```

### Windows Setup

[Permalink: Windows Setup](https://github.com/SesameAILabs/csm#windows-setup)

The `triton` package cannot be installed in Windows. Instead use `pip install triton-windows`.

## Usage

[Permalink: Usage](https://github.com/SesameAILabs/csm#usage)

Run the example script:

```
python run_csm.py
```

You can also create your own script using the example code below.

Generate a sentence

```
from generator import load_csm_1b
import torchaudio
import torch

if torch.backends.mps.is_available():
    device = "mps"
elif torch.cuda.is_available():
    device = "cuda"
else:
    device = "cpu"

generator = load_csm_1b(device=device)

audio = generator.generate(
    text="Hello from Sesame.",
    speaker=0,
    context=[],
    max_audio_length_ms=10_000,
)

torchaudio.save("audio.wav", audio.unsqueeze(0).cpu(), generator.sample_rate)
```

CSM sounds best when provided with context. You can prompt or provide context to the model using a `Segment` for each speaker's utterance.

```
from generator import Segment

speakers = [0, 1, 0, 0]
transcripts = [\
    "Hey how are you doing.",\
    "Pretty good, pretty good.",\
    "I'm great.",\
    "So happy to be speaking to you.",\
]
audio_paths = [\
    "utterance_0.wav",\
    "utterance_1.wav",\
    "utterance_2.wav",\
    "utterance_3.wav",\
]

def load_audio(audio_path):
    audio_tensor, sample_rate = torchaudio.load(audio_path)
    audio_tensor = torchaudio.functional.resample(
        audio_tensor.squeeze(0), orig_freq=sample_rate, new_freq=generator.sample_rate
    )
    return audio_tensor

segments = [\
    Segment(text=transcript, speaker=speaker, audio=load_audio(audio_path))\
    for transcript, speaker, audio_path in zip(transcripts, speakers, audio_paths)\
]
audio = generator.generate(
    text="Me too, this is some cool stuff huh?",
    speaker=1,
    context=segments,
    max_audio_length_ms=10_000,
)

torchaudio.save("audio.wav", audio.unsqueeze(0).cpu(), generator.sample_rate)
```

## FAQ

[Permalink: FAQ](https://github.com/SesameAILabs/csm#faq)

**Does this model come with any voices?**

The model open-sourced here is a base generation model. It is capable of producing a variety of voices, but it has not been fine-tuned on any specific voice.

**Can I converse with the model?**

CSM is trained to be an audio generation model and not a general-purpose multimodal LLM. It cannot generate text. We suggest using a separate LLM for text generation.

**Does it support other languages?**

The model has some capacity for non-English languages due to data contamination in the training data, but it likely won't do well.

## Misuse and abuse ⚠️

[Permalink: Misuse and abuse ⚠️](https://github.com/SesameAILabs/csm#misuse-and-abuse-%EF%B8%8F)

This project provides a high-quality speech generation model for research and educational purposes. While we encourage responsible and ethical use, we **explicitly prohibit** the following:

- **Impersonation or Fraud**: Do not use this model to generate speech that mimics real individuals without their explicit consent.
- **Misinformation or Deception**: Do not use this model to create deceptive or misleading content, such as fake news or fraudulent calls.
- **Illegal or Harmful Activities**: Do not use this model for any illegal, harmful, or malicious purposes.

By using this model, you agree to comply with all applicable laws and ethical guidelines. We are **not responsible** for any misuse, and we strongly condemn unethical applications of this technology.

* * *

## Authors

[Permalink: Authors](https://github.com/SesameAILabs/csm#authors)

Johan Schalkwyk, Ankit Kumar, Dan Lyth, Sefik Emre Eskimez, Zack Hodari, Cinjon Resnick, Ramon Sanabria, Raven Jiang, and the Sesame team.

## About

A Conversational Speech Generation Model


### Resources

[Readme](https://github.com/SesameAILabs/csm#readme-ov-file)

### License

[Apache-2.0 license](https://github.com/SesameAILabs/csm#Apache-2.0-1-ov-file)

[Activity](https://github.com/SesameAILabs/csm/activity)

[Custom properties](https://github.com/SesameAILabs/csm/custom-properties)

### Stars

[**11.6k**\\
stars](https://github.com/SesameAILabs/csm/stargazers)

### Watchers

[**791**\\
watching](https://github.com/SesameAILabs/csm/watchers)

### Forks

[**955**\\
forks](https://github.com/SesameAILabs/csm/forks)

[Report repository](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FSesameAILabs%2Fcsm&report=SesameAILabs+%28user%29)

## [Releases](https://github.com/SesameAILabs/csm/releases)

No releases published

## [Packages\  0](https://github.com/orgs/SesameAILabs/packages?repo_name=csm)

No packages published

## [Contributors\  12](https://github.com/SesameAILabs/csm/graphs/contributors)

- [![@ZackHodari](https://avatars.githubusercontent.com/u/9717211?s=64&v=4)](https://github.com/ZackHodari)
- [![@darkmirage](https://avatars.githubusercontent.com/u/1635019?s=64&v=4)](https://github.com/darkmirage)
- [![@JohanSchalkwyk1](https://avatars.githubusercontent.com/u/171366163?s=64&v=4)](https://github.com/JohanSchalkwyk1)
- [![@rhb](https://avatars.githubusercontent.com/u/892539?s=64&v=4)](https://github.com/rhb)
- [![@aviadr1](https://avatars.githubusercontent.com/u/6078554?s=64&v=4)](https://github.com/aviadr1)
- [![@MahanRahmati](https://avatars.githubusercontent.com/u/16052180?s=64&v=4)](https://github.com/MahanRahmati)
- [![@eltociear](https://avatars.githubusercontent.com/u/22633385?s=64&v=4)](https://github.com/eltociear)
- [![@akashjss](https://avatars.githubusercontent.com/u/45600900?s=64&v=4)](https://github.com/akashjss)
- [![@NielsRogge](https://avatars.githubusercontent.com/u/48327001?s=64&v=4)](https://github.com/NielsRogge)
- [![@MHRDYN7](https://avatars.githubusercontent.com/u/113298714?s=64&v=4)](https://github.com/MHRDYN7)
- [![@jannismoore](https://avatars.githubusercontent.com/u/148906570?s=64&v=4)](https://github.com/jannismoore)
- [![@akash-gupta-parloa](https://avatars.githubusercontent.com/u/149550276?s=64&v=4)](https://github.com/akash-gupta-parloa)

## Languages

- [Python100.0%](https://github.com/SesameAILabs/csm/search?l=python)

You can’t perform that action at this time.